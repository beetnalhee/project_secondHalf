<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{/layout/template :: template(~{this :: title}, ~{this :: script},  ~{this :: css}, ~{this :: content})}">

<head>
    <title th:fragment="title"> ::: 동네친구:모임 제목 ::: </title>
    <th:block th:fragment="script">
    </th:block>
    <th:block th:fragment="css">
        <link rel="stylesheet" href="/css/index.css">
        <link rel="stylesheet" href="/css/meet.css">
    </th:block>
</head>

<div class="wrapper" th:fragment="content">
    <div id="meet-read-wrap">
        <div id="meet-read-writer-wrap">
            <div id="meet-read-writer">
                <p id="meet-read-writer-name" th:text="${meetArticleDto.memberId}">김순자 최고</p>
            </div>
            <p id="meet-read-date" th:text="${meetArticleDto.regdate}">2024. 05. 14.(화) 17:31 작성</p>
        </div>
        <div id="meet-read-content-wrap">
            <h1 id="meet-read-title" th:text="${meetArticleDto.title}">다이소 같이 가실 분</h1>
            <p class="meet-read-content" th:text="${meetArticleDto.time}">-시간 : 2024. 6. 13.(목) 18:00</p>
            <p class="meet-read-content" th:text="${meetArticleDto.placeId}">-장소 : 다이소 노원역점</p>
            <p class="meet-read-content" th:text="${meetArticleDto.content}">본문 내용이 들어가면 됩니다</p>
        </div>
        <div class="register-btn-wrap">
            <button class="back-btn" th:onclick="history.back(-1)">돌아가기</button>
            <button class="register-btn">참여하기</button>
            <th:block th:if="${loginMember != null}">
                <th:block th:if="${loginMember.memberId == meetArticleDto.memberId}">
                    <form id="updateForm" method="get"
                          th:action="@{/meet/{categoryId}/update/{meetArticleId}(categoryId=${categoryId}, meetArticleId=${meetArticleId})}">
                        <button type="button" class="btn btn-dark" onclick="updateForm()">수정</button>
                    </form>
                    <form id="deleteForm" method="post" th:action="@{/meet/{categoryId}/delete/{meetArticleId}}"
                          th:attr="data-categoryId=${categoryId}, data-meetArticleId=${meetArticleId}">
                        <button type="button" class="btn btn-dark" onclick="confirmDelete()">삭제</button>
                    </form>
                </th:block>
            </th:block>
            <script th:inline="javascript">
                function confirmDelete() {
                    if (confirm('정말로 이 게시글을 삭제하시겠습니까?')) {
                        let form = document.getElementById("deleteForm");
                        let categoryId = form.getAttribute("data-categoryId");
                        let meetArticleId = form.getAttribute("data-meetArticleId");
                        form.setAttribute("action", "/meet/" + categoryId + "/delete/" + meetArticleId);
                        form.submit();
                    }
                }
            </script>
            <script>
                function updateForm() {
                    document.getElementById("updateForm").submit();
                }
            </script>
        </div>
        <div class="review-wrap">
            <div id="review-count-wrap">
                <p th:text="'댓글(' + ${replyCount} + ')'">댓글(3)</p>
                <p th:text="'조회수(' + ${meetArticleDto.hitcount} + ')'">조회수</p>
            </div>
        </div>
        <th:block th:if="${loginMember != null}">
            <div class="review-wrap">
                <form id="meet-register-form" method="post">
                    <div id="write-review">
                        <p name="writer" th:text="'작성자 : ' + ${loginMember.memberId}"></p>
                        <div id="review-text">
                            <textarea name="content" cols="62" rows="2"></textarea>
                            <button type="submit" id="write-review-btn">등록</button>
                        </div>
                    </div>
                </form>
                <div class="review" th:each="reply : ${replyList}">
                    <div>
                        <img src="/img/profile.png">
                    </div>
                    <div>
                        <ul>
                            <li class="review-writer" th:text="${reply.writer}">작성자명</li>
                            <li class="review-content" th:text="${reply.content}">시간이 너무 빨리 지나가는 것 같아요...</li>
                        </ul>
                    </div>
                </div>
            </div>
        </th:block>
    </div>
</div>
</div>
</html>

